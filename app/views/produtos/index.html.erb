<div class="col-md-12 scroltable">
	<div class="col-md-12">
    <h3>Lista de Produtos</h3>
  </div>
  <!-- Page Heading/Breadcrumbs -->
  <%= render :partial => 'shared/header_backoffice' %>
  <!-- /.row -->  

  <div>
    <form action="" method="get" id="formApuracao">
      <div class="col-sm-2">
        <div class="form-group">
          <label>Código Produto Pagasó</label>
          <div>
            <input type="text" name="id" value="<%= params[:id] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="col-sm-2">
        <div class="form-group">
          <label>Código Produto Parceiro</label>
          <div>
            <input type="text" name="produto_id_parceiro" value="<%= params[:produto_id_parceiro] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="form-group">
          <label>Nome do Produto na Operadora</label>
          <div>
            <input type="text" name="nome" value="<%= params[:nome] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="form-group">
          <label>Nome Comercial do Produto</label>
          <div>
            <input type="text" name="nome_comercial" value="<%= params[:nome_comercial] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="form-group">
          <label>Nome do Parceiro</label>
          <div>
            <select name="parceiro_id" class="form-control">
              <option value="" selected="'selected'">Todos</option>
              <% Partner.all.each do |partner| %>
                <option value="<%= partner.id %>" <% if partner.id.to_s == params[:parceiro_id] %> selected="selected" <% end %> ><%= partner.name %></option>
              <% end %>
            </select>
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="form-group">
          <label>Moeda</label>
          <div>
            <select name="moeda_id" class="form-control">
              <option value="" selected="'selected'">Todos</option>
              <% Moeda.all.each do |moeda| %>
                <option value="<%= moeda.id %>" <% if moeda.id.to_s == params[:moeda_id] %> selected="selected" <% end %> ><%= "#{moeda.id}/#{moeda.simbolo}" %></option>
              <% end %>
            </select>
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="form-group">
          <label>Status do Produto</label>
          <div>
            <select name="status_produto_id" class="form-control">
              <option value="" selected="'selected'">Todos</option>
              <% StatusProduto.all.each do |status_produto| %>
                <option value="<%= status_produto.id %>" <% if status_produto.id.to_s == params[:status_produto_id] %> selected="selected" <% end %> ><%= status_produto.nome %></option>
              <% end %>
            </select>
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="form-group">
          <label>Data do Início da Vigência</label>
          <div>
            <input type="date" name="data_vigencia" value="<%= params[:data_vigencia] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="form-group">
          <label>Data da Criação (INÍCIO)</label>
          <div>
            <input type="date" name="created_at" value="<%= params[:created_at] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="form-group">
          <label>Data da Criação (FIM)</label>
          <div>
            <input type="date" name="created_at_fim" value="<%= params[:created_at_fim] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="form-group">
          <label>Data de Atualização (INÍCIO)</label>
          <div>
            <input type="date" name="updated_at" value="<%= params[:updated_at] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="form-group">
          <label>Data de Atualização (FIM)</label>
          <div>
            <input type="date" name="updated_at_fim" value="<%= params[:updated_at_fim] %>" class="form-control">
          </div>
        </div>
      </div>
      <div class="form-group pull-right">
          <input type="submit" class="btn btn-info" value="Buscar">
          <%= link_to 'javascript:history.go(-1)', class: 'btn btn-danger' do %>
            <span class="glyphicon glyphicon-list-alt"></span>
            Tela Anterior
          <% end %>

          <%= link_to new_produto_path, class: 'btn btn-danger' do %>
            <span class="glyphicon glyphicon-plus"></span>
            Novo Registo
          <% end %>

          <%= link_to backoffice_index_path, class: 'btn btn-dark' do %>
            <span class="glyphicon glyphicon-plus"></span>
            Backoffice
          <% end %>
        </div>
      </div>
    </form>
  </div>
  <div class="col-md-12 scroltable">
    <table class="table table-hover">
      <thead>
        <tr>
          <th scope="col">Produto</th>
          <th scope="col">Parceiro</th>
          <th scope="col">Valor</th>
          <th scope="col">Tipo/Subtipo</th>
          <th scope="col">Datas</th>
          <th colspan="3">Ações para o Registo</th>
        </tr>
      </thead>

      <tbody>
        <% @produtos.each do |produto| %>
        <tr>
          <td style="width: 400px">
            <b>Código Produto Pagasó:</b> <%= produto.id %><br>
            <b>Código Produto Parceiro:</b> <%= produto.produto_id_parceiro %><br>
            <b>Descrição do Produto na Operadora</b> <br>
            <%= produto.description %><br>
            <b>Nome Comercial do Produto</b> <br>
            <%= produto.nome_comercial %>
          </td>
          <td style="width: 200px">
            <b>Parceiro</b> <br>
            <%= produto.partner.name %><br>
            <b>Moeda</b> <br>
            <%= "#{produto.moeda_id}/#{(produto.moeda.simbolo rescue "")}" %><br>
            <b>Status</b> <br>
            <%= produto.status_produto.nome %><br>
          </td>
          <td style="width: 200px">
            <b>$ Unitário</b> <br>
            <%= number_to_currency(produto.valor_unitario) %></br>
            <b>$ Compra Telemóvel</b> <br>
            <%= number_to_currency(produto.valor_compra_telemovel) %></br>
          </td>
          <td style="width: 150px">
            <b>Tipo</b> <br>
            <%= produto.tipo %></br>
            <b>Subtipo</b> <br>
            <%= number_to_currency(produto.valor_compra_telemovel) %></br>
          </td>
          <td style="width: 230px">
            <b>Criação</b><br>
            <%= produto.created_at.strftime("%d/%m/%Y %H:%M:%S") %><br>
            <b>Atualização</b><br>
            <%= produto.updated_at.strftime("%d/%m/%Y %H:%M:%S") %><br>
            <b>Início da Vigência</b><br>
            <%= produto.data_vigencia.strftime("%d/%m/%Y %H:%M:%S") rescue "" %>
          </td>
          <td><%= link_to 'Mostrar', produto %></td>
          <td><%= link_to 'Editar', edit_produto_path(produto) %></td>
          <td><%= link_to 'Apagar', produto, method: :delete, data: { confirm: 'Tem certeza?' } %></td>
        </tr>
        <% end %>
      </tbody>
    </table>

    <div class="apple_pagination">
      <%= will_paginate @produtos, :container => false %>
    </div> 

    <%= link_to 'javascript:history.go(-1)', class: 'btn btn-danger' do %>
      <span class="glyphicon glyphicon-list-alt"></span>
      Tela Anterior
    <% end %>

    <%= link_to new_produto_path, class: 'btn btn-danger' do %>
      <span class="glyphicon glyphicon-plus"></span>
      Novo Registo
    <% end %>

    <%= link_to backoffice_index_path, class: 'btn btn-dark' do %>
      <span class="glyphicon glyphicon-plus"></span>
      Backoffice
    <% end %>  </div>
</div>