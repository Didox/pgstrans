<div class="container scroltable">
  <!-- Page Heading/Breadcrumbs -->
  <%= render :partial => 'shared/header_backoffice' %>
  <!-- /.row -->

  <div class="container">
    <% if flash[:mensagem_erro_fatura].present? %>
      <div class="erro_pagamento">
        <%= flash[:mensagem_erro_fatura] %>
      </div>
    <% else %>
      <div class="card" style="margin-top: 5px;">
        <div class="card-header">
          <div class="col-md-8">
            Selecione o Produto (no máximo 2)
          </div>
          <% if params[:customer_number].present? %>
            <div class="col-md-4">
              Número do Cliente: <%= params[:customer_number] %>
            </div>
          <% end %>
          <div class="container scroltable">
            <script>
              var validaSelecionaProdutos = function(form) {
                if($(form).find(".produtojs:checked").length == 0){
                  alert("Selecione o Produto (no máximo 2)")
                  return false
                }
                return true
              }
            </script>
            <form action="/dstv/alteracao-cliente-produtos/upgrade-downgrade" onsubmit="return validaSelecionaProdutos(this)" method="get">

              <div>
                <div style="background-color: #F2F3F4;padding: 10px;color: #000;">
                  <table class="table">
                    <tr>
                      <th>#</th>
                      <th>
                        Descrição
                      </th>
                      <th>
                        Valor
                      </th>
                    </tr>
                    <% @produtos.each do |produto| %>
                      <tr>
                        <td>
                          <input type="checkbox" class="produtojs" name="produtos[]" onclick="selecionaMaximoDoisProdutos(this)" value="<%= produto.id %>">
                        </td>
                        <td>
                          <%= produto.description %>
                        </td>
                        <td>
                          <%= number_to_currency(produto.valor_compra_telemovel, :unit => "KZ") %>
                        </td>
                      </tr>
                    <% end %>
                  </table>
                </div>
                <div class="saveCancelbts" style="padding-top: 25px;padding-bottom: 25px;text-align: right;">
                  <input type="hidden" value="<%= params[:smartcard] %>" name="smartcard">
                  <input type="hidden" value="<%= params[:customer_number] %>" name="customer_number">
                  
                  <div style="display: inline-block;margin-bottom: 10px;">
                    <%= link_to href="/?recarga=DSTv", class: 'btn btn-space btn-danger', style: "width: 150px;text-align: center;margin-right: 0px;" do %>
                      <span class="glyphicon glyphicon-list-alt"></span>
                      VOLTAR
                    <% end %>
                  </div>
                  <div style="display: inline-block;margin-bottom: 10px;">
                    <input type="submit" class="btn btn-success" style="width: 150px; text-align: center;" value="CONFIRMAR">
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <script>
        var selecionaMaximoDoisProdutos = function(elen) {
          if($(".produtojs:checked").length > 2){
            $(elen).prop( "checked", false );
          }
        }
      </script>
    <% end %>
  </div>
</div>