<div class="col-md-12" data-target="toggle.grid">
  <div class="card border-simpleform box-shadow mb-4">
    <div class="card-header text-simpleform d-flex align-items-center justify-content-between">
      <div>
        <strong>Dados dos Usuários</strong><br>
      </div>
    </div>
  </div>

  <div class="col-md-12 card border-bootstrap box-shadow mb-4">
    <div class="card-header text-bootstrap align-items-center justify-content-between">

      <%= simple_form_for(@usuario) do |f| %>
        <% if @usuario.errors.any? %>
          <div class="alert alert-danger alert-dismissable" role="alert">
            <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4><%= pluralize(@usuario.errors.count, "erros") %> no cadastro usuários, confira abaixo:</h4>

            <ul>
            <% @usuario.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
            </ul>
          </div>
        <% end %>

        <div class="form-input col-sm-6">
          <%= f.input :nome, :label => "Nome", placeholder: "Informe o nome completo do usuário" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.input :email, :label => "E-Mail", placeholder: "Informe um e-mail válido" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.label :senha, "Palavra-passe" %>
          <%= f.password_field :senha, class: "form-control" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.label :perfil_usuario_id, "Perfil do Usuário" %>
          <% if @adm.admin? %>
            <%= f.select :perfil_usuario_id, PerfilUsuario.all.collect{|d| [d.nome, d.id]}, {:include_blank => "[Selecione]"}, required:true, class: "form-control" %>
          <% else %>
            <%= f.select :perfil_usuario_id, PerfilUsuario.where(admin: false).collect{|d| [d.nome, d.id]}, {:include_blank => "[Selecione]"}, required:true, class: "form-control" %>
          <% end %>
        </div>
  
        <div class="form-input col-sm-6">
          <%= f.label :sub_agente_id %>
          <%= f.select :sub_agente_id, SubAgente.all.collect{|d| [d.nome_fantasia, d.id]}, {:include_blank => "[Selecione]"}, required:true, class: "form-control" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.label :status_cliente_id %>
          <%= f.select :status_cliente_id, StatusCliente.all.collect{|d| [d.nome, d.id]}, {:include_blank => "[Selecione]"}, required:true, class: "form-control" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.input :morada, :label => "Morada", placeholder: "Informe a morada do usuário" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.input :bairro, :label => "Bairro", placeholder: "Informe o bairro do usuário" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.label :municipio_id, :label => "Município" %>
          <%= f.select :municipio_id, Municipio.all.collect{|d| [d.nome, d.id]}, {:include_blank => "[Selecione]"}, required:true, class: "form-control" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.label :provincia_id, :label => "Província" %>
          <%= f.select :provincia_id, Provincium.all.collect{|d| [d.nome, d.id]}, {:include_blank => "[Selecione]"}, required:true, class: "form-control" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.label :uni_pessoal_empresa_id, :label => "Tipo" %>
          <%= f.select :uni_pessoal_empresa_id, UniPessoalEmpresa.all.collect{|d| [d.nome, d.id]}, {:include_blank => "[Selecione]"}, required:true, class: "form-control" %>
        </div>

        <div class="form-input col-sm-6">
          <%= f.label :industry_id, "Grupo de Atividade Económica" %>
          <%= f.select :industry_id, Industry.all.collect{|d| [d.descricao_grupo, d.id]}, {:include_blank => "[Selecione]"}, required:true, class: "form-control" %>      
        </div>
      </div>
      
      <hr>

      <div class="form-group col-sm-12">
        <%= f.label :acessos, "Grupos", class: "col-sm-5 control-label" %>
        <br><hr>
        <input type="button" value="SELECIONAR TODOS" onclick="checkAcessos()" class="btn btn-success">
        <input type="button" value="DESMARCAR TODOS" onclick="uncheckAcessos()" class="btn btn-danger">
        <label>Ou selecionar os itens individualmente para definir os grupos</label>        
        <br><hr>
        <div class="col-sm-10">
          <ul>
            <% Grupo.all.each do |grupo| %>
              <li>
                <label><%= grupo.nome %></label>
                <% checked = @usuario.grupo_usuarios.where(grupo_id: grupo.id).count > 0 ? "checked='checked'" : "" %>
                <input type="checkbox" name="grupos[]" <%= checked %> class="check-acessos" value="<%= grupo.id %>">
              </li>
            <% end %>
          </ul>
        </div>
      </div>
        <div class="form-actions col-sm-12">
          <%= f.button :button, class: 'btn btn-danger' do %>
            <span class="glyphicon glyphicon-ok"></span>
            Confirmar
          <% end %>
        </div>
      <% end %>
    <br>
  </div>
</div>